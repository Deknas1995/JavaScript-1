<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administration</title>
    <link rel="stylesheet" href="../../CSS/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>


<body>

<header>
    <h1 class="banner">Administration</h1>
</header>

<div class="admin-grid">
    
    <div class="sidebar">
        <p>Produkter</p>
    </div>
    
    <div class="column2">

        <div class="product-table-header">
            <p>Produkter</p>
            <button id="load-products-btn">Ladda produkter</button>
            <a href="/admin/products/new">Ny produkt</a>
        </div>

        <div id="product-table">
            <table>
                <thead>
                    <tr>
                        <th>Namn</th>
                        <th>SKU</th>
                        <th>Pris</th>
                    </tr>
                </thead>
                
                <!--Fill dynamically by fetch api-->
                <tbody>
                    <!--
                    <tr>
                        <td>Svart T-Shirt</td>
                        <td>AAA111</td>
                        <td>199</td>
                    </tr>
                    <tr>
                        <td>Vit T-Shirt</td>
                        <td>BBB111</td>
                        <td>199</td>
                    </tr>
                    <tr>
                        <td>...</td>
                    </tr>
                    -->
                </tbody>

                <script>
                    document.addEventListener('DOMContentLoaded', function() 
                    {
                        const loadProductsBtn = document.getElementById('load-products-btn');
                        const productTableBody = document.querySelector('#product-table tbody');

                        loadProductsBtn.addEventListener('click', () => 
                        {
                            fetch('/api/getProducts')
                                .then(response => 
                                {
                                    if (!response.ok) 
                                    {
                                        throw new Error('Network response was not ok');
                                    }
                                    return response.json();
                                })
                                .then(products => 
                                {
                                    // Rensa tabellen innan vi lägger till nya produkter
                                    productTableBody.innerHTML = '';

                                    // Gå igenom produkterna och skapa rader
                                    products.forEach(product => 
                                    {
                                        const row = document.createElement('tr');
                                        row.innerHTML = `
                                            <td>${product.name}</td>
                                            <td>${product.sku}</td>
                                            <td>${product.price} SEK</td>
                                        `;
                                        productTableBody.appendChild(row);
                                    });
                                })
                                .catch(error => 
                                {
                                    console.error('Det blev ett problem med fetch-operationen:', error);
                                });
                        });
                    });
                </script>
            </table>
        </div>
        
    </div>
</div>

<footer>

</footer>

</body>
</html>
    